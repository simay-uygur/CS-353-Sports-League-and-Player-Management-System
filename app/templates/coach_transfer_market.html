<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
  <title>Transfer Market | CS353</title>
</head>

<body class="dashboard-body">
  {% include "_banner.html" %}
  <div class="dashboard-container">
    <div class="admin-header">
      <div>
        <p class="eyebrow">Coach Portal</p>
        <h1>Transfer Market</h1>
      </div>
    </div>

    <!-- Player filtering Section -->
    <div class="create-card">
      <form class="create-card-inner" method="GET" action="{{ url_for('coach.view_transfer_market') }}">
        <div class="match-grid">
          <div class="form-group">
            <label for="nationality">Nationality</label>
            <select name="nationality" id="nationality-filter">
              <option value="" selected>Any</option>
              {% for nationality in nationalities %}
              <option value="{{ nationality['nationality'] }}">{{ nationality['nationality'] }}</option>
              {% endfor %}
            </select>
          </div>
          <div class="form-group">
            <label for="pos">Position</label>
            <select name="pos" id="position-filter">
              <option value="" selected>Any</option>
              {% for position in positions %}
              <option value="{{ position['position'] }}">{{ position['position'] }}</option>
              {% endfor %}
            </select>
          </div>
          <div class="form-group">
            <label for="minAge">Minimum Age</label>
            <input type="text" id="minAge" name="minAge" inputmode="numeric" pattern="[0-9]*" placeholder="15">
          </div>
          <div class="form-group">
            <label for="maxAge">Maximum Age</label>
            <input type="text" id="maxAge" name="maxAge" inputmode="numeric" pattern="[0-9]*" placeholder="99">
          </div>
          <div class="form-group">
            <label for="contactExpirationDate">Contract Expiration Date</label>
            <input type="date" id="contactExpirationDate" name="contactExpirationDate">
          </div>
          <div class="form-group">
            <label for="team">Team</label>
            <select name="team" id="team-filter">
              <option value="" selected>Any</option>
              {% for team in teams %}
              <option value="{{ team['teamid'] }}">{{ team['teamname'] }}</option>
              {% endfor %}
            </select>
          </div>
          <div class="form-group" style="grid-column: span 2;">
            <label for="search-input">Player name </label>
            <div style="display: flex; gap: 0.5rem; align-items: center;">
              <input type="text" id="search-input" name="name" placeholder="Search players..." style="flex: 2; min-width: 200px;">
              <div class="filter-actions" style="display: flex; gap: 0.5rem;">
                <button type="submit" class="btn small">Apply Filters</button>
                <a href="{{ url_for('coach.view_transfer_market') }}" class="btn small ghost">Clear Filters</a>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>

    <!-- Player Table Section -->
    <div class="bracket-panel">
      <table style="width: 100%; border-collapse: collapse;">
        <thead>
          <tr style="border-bottom: 2px solid #e5e7eb;">
            <th style="text-align: left; padding: 0.75rem 1rem; color: #0f172a;">Name</th>
            <th style="text-align: left; padding: 0.75rem 1rem; color: #0f172a;">Birthdate</th>
            <th style="text-align: left; padding: 0.75rem 1rem; color: #0f172a;">Nationality</th>
            <th style="text-align: left; padding: 0.75rem 1rem; color: #0f172a;">Position</th>
            <th style="text-align: left; padding: 0.75rem 1rem; color: #0f172a;">Team</th>
            <th style="text-align: left; padding: 0.75rem 1rem; color: #0f172a;">Salary</th>
            <th style="text-align: left; padding: 0.75rem 1rem; color: #0f172a;">Contract Expires</th>
            <th style="text-align: center; padding: 0.75rem 1rem; color: #0f172a;">Action</th>
          </tr>
        </thead>
        <tbody>
          {% for player in players %}
          <tr style="border-bottom: 1px solid #e5e7eb;">
            <td style="padding: 0.75rem 1rem; font-weight: 600;">{{ player['firstname'] }} {{player['lastname']}}</td>
            <td style="padding: 0.75rem 1rem; color: #6b7280;">{{ player['birthdate'] }}</td>
            <td style="padding: 0.75rem 1rem; color: #6b7280;">{{ player['nationality'] }}</td>
            <td style="padding: 0.75rem 1rem; color: #6b7280;">{{ player['position'] }}</td>
            <td style="padding: 0.75rem 1rem; color: #6b7280;">{{ player['teamname'] }}</td>
            <td style="padding: 0.75rem 1rem; color: #6b7280;">{{ player['salary'] }}</td>
            <td style="padding: 0.75rem 1rem; color: #6b7280;">{{ player['enddate']}}</td>
            <td style="padding: 0.75rem 1rem; text-align: center;">
              <a href="{{url_for('coach.transfer_offer', player_id=player['usersid'])}}" class="btn solid" style="padding: 0.5rem 1rem; text-decoration: none; display: inline-block;">Offer</a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      {% if not players %}
      <p class="empty-state" style="text-align: center; padding: 2rem;">No players found matching your criteria.</p>
      {% endif %}
    </div>
  </div>
  <style>
    /* Remove number spinners for transfer market filters */
    .create-card input[type="text"][inputmode="numeric"]::-webkit-outer-spin-button,
    .create-card input[type="text"][inputmode="numeric"]::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    .create-card input[type="text"][inputmode="numeric"] {
      -moz-appearance: textfield;
    }
  </style>
</body>

</html>
